use super::piece;
const BLACK_PIECES: [u64; 729] = [
  5506693762979010788,
  2069683462394836564,
  6456315031298751912,
  9260484363999622783,
  7859375247160655709,
  11011262345142343811,
  16313770867230846713,
  5915161771709277588,
  208106401134557509,
  3050813604872795976,
  808512220627510601,
  13521899635027903594,
  2085977639334993700,
  14844862726738920344,
  1682558392991322817,
  12619855699779372841,
  8937451436655073779,
  13036755200875893573,
  10227718351014554597,
  16008676739360404284,
  4427785592112753231,
  11676977993065271536,
  11269746518494840863,
  4587570481092619960,
  7632489869662174978,
  13401077084443994806,
  18151572522868345086,
  4997958256024178624,
  4813723089425806535,
  12973587216645700772,
  11188840075296501449,
  13381544623111306967,
  8168971137694330551,
  4387118064742749673,
  16560903186524876014,
  13921423597567779846,
  422281463814745196,
  7245162712672897578,
  4250600684835164806,
  3489049434674196748,
  13929741446168036768,
  4270918359895634163,
  8918775537367564984,
  17118425605575144025,
  3445405099827256915,
  2422709224150043429,
  10507748965431501542,
  7527788329434792915,
  5750805079891673392,
  2329276652056592703,
  8227880112647256851,
  2158037724342239512,
  4524767187320241995,
  21403499595257896,
  9154060570011044009,
  17378197057365978508,
  8723689419328309823,
  16592551018599290836,
  4636392305678578977,
  12495573138691362274,
  708604508034493251,
  7430080898539771740,
  17022079794849716435,
  1506816585917285742,
  7772533499189594181,
  12265028675687759920,
  13829678768563492199,
  4658516958836636272,
  6163337240541566449,
  2568909337247564997,
  17087065055258835192,
  11797489530418977992,
  15886116791105634717,
  8515668572680258587,
  11489824222653268544,
  4706423904036053040,
  10738850315643200158,
  8692598711763534044,
  6648298112374630523,
  8617782608984446850,
  994751335242916659,
  8781820657209659483,
  10823160630897384171,
  3558644986314980493,
  9765483124362404065,
  1557750952941153289,
  3564214260026541327,
  13411096475085309571,
  92793932202858639,
  6554750032270174359,
  8592682418188856052,
  2815114616818633959,
  10938825145667011746,
  18075088209808362520,
  5935225948269794593,
  13917489195832491827,
  2301227286593853266,
  17157095815180753524,
  3679959638907654884,
  11931902930375891248,
  10600151532652901646,
  7239495344955039727,
  14230828092524489276,
  12340176388586687313,
  10770081041480252036,
  16236221758219980009,
  5467951463070112491,
  12861226774825487853,
  3581251891125963976,
  815863094277428501,
  18288313239572862735,
  3248487595931075365,
  10442645177294104773,
  1441584904192162487,
  15684794401948409757,
  2240894674111379372,
  7397687458646780151,
  13248815698483420746,
  471740167474465208,
  8909794456662118712,
  2184063248021011165,
  3525740460496958715,
  3657879806521563438,
  13266177922035352398,
  8324583838454880592,
  15622758941315046759,
  9711703098821459350,
  13286894170946013939,
  9812076151679556034,
  6745528473901417009,
  16432710364886984543,
  6935865674350873569,
  16944941192664128840,
  12638948088348108526,
  10178785841327098694,
  4583111399372521124,
  3466558693514847676,
  12928422188369091854,
  9205318122344054938,
  3597769288504530884,
  17161063319036990916,
  10123018118985658313,
  13490218361485572743,
  15189940185994320078,
  3804203799675668876,
  8331351223659832343,
  15084075742491893379,
  16957912851345486662,
  2192340684207566523,
  12530054378753635392,
  863187729822878983,
  5410226252271234210,
  709183657864685581,
  17881059535805186389,
  11062595576109521639,
  1300195223296893437,
  11020281719786819090,
  6537428134929794914,
  14026588088813263714,
  5284941221189631448,
  14413991559361981364,
  16081369973238788836,
  17945759951587354320,
  14162646606060416361,
  2928670218363186896,
  14498539150427200167,
  13440856439560392670,
  12992407082532582760,
  18007283985219656592,
  6382437445115029019,
  12752420136094146271,
  7973839791725472881,
  14150674821168977508,
  11567410099667694316,
  4531260744901165433,
  17993850744828466415,
  528812078480464592,
  9201637649177210313,
  10097471337248819404,
  1522540672351537592,
  4453150227863705247,
  14423169554757234585,
  1801312737883013427,
  17800951799854633971,
  3140716631159599209,
  12885094549218881998,
  6534792544715476524,
  5705536355446762497,
  1215780596962694711,
  979392237243100809,
  695484332873011862,
  9360809314096677279,
  14111687878109013538,
  7549022182756195180,
  11734759279005776982,
  13623937613849102808,
  3886140489942456502,
  7632529662239855200,
  1702061518275326558,
  2782528551645000450,
  3135766868935368120,
  3216155750806071057,
  14221815050860616977,
  5315564772225619096,
  3608085336493650691,
  3104479921155206516,
  10510763937931242161,
  13704778055472945946,
  16807150738950958558,
  6400534414978558076,
  5303189603821846621,
  14203700894174980586,
  6277371572731420499,
  1553203415144354381,
  15153258969520409483,
  10593762937894730665,
  18365926557202492647,
  7692805604225939258,
  871901676947791927,
  18135558058776573764,
  13865429543906247624,
  11367434092251655766,
  8940630553341391663,
  8420444442423259172,
  15100200502370459958,
  15645835093972545867,
  8636627014773515827,
  17912295086015549975,
  3931838190833993490,
  6149614588846390660,
  7781735310010355846,
  7305163299587887548,
  8062211909934211040,
  17757361870806400699,
  2464744923362589662,
  17227596351893035774,
  6801791237655556160,
  1121906835679585304,
  13266433871576206947,
  6952368606862576281,
  12302932053471335475,
  1735537975736959810,
  6330578286918126208,
  12118136408349812915,
  6777508129227126536,
  16165045463996214769,
  5233962530864606096,
  5242965602945936245,
  6924460566279095236,
  9812778312873295386,
  12196573027555211248,
  13988388534385575706,
  12266278317778423741,
  17060847481855719023,
  4156963197641197813,
  6719175727388544354,
  8922787802404508863,
  10561954786698955424,
  8459069740626146524,
  14938954407868662850,
  3993796556938222924,
  5388451701601198434,
  16733553526744005766,
  15116107302942879260,
  9087947912083921019,
  6719372872860791944,
  17740020176177124868,
  3130515596770603023,
  14123672508807889953,
  10339312331784009588,
  8353034218609614172,
  773090159737673148,
  7581471747037432261,
  12620791042918995709,
  13647623612122139279,
  10402271635847610181,
  15290353016099658699,
  18374464121440976446,
  12059900452471254069,
  17796879323918993106,
  3902208439168038427,
  5550844723813716585,
  17555246796935699838,
  18321912643044240130,
  3494568529927130611,
  4887284203626332958,
  10996566294506297435,
  3191313097434275911,
  4633080205227348350,
  681398553103152637,
  1498614479049040701,
  11039529993828025480,
  13721135394231464919,
  3361145320025903591,
  15661499032981620716,
  451948745452502128,
  13857788463834145792,
  14578839060490177608,
  15270069897909502712,
  17869382017656986270,
  9534608586333999417,
  14293606774725977906,
  16444948168919581455,
  929591449150486396,
  3027370230930546674,
  16281822131198929615,
  13406044932291126656,
  14740501833893398174,
  14938449871852749344,
  4319800889350120749,
  77856821720192877,
  12514285537153790168,
  15680665315656267793,
  12093252638015116171,
  15064641216166064124,
  9392867398057100041,
  2607511082256155909,
  4537841346807617196,
  5839478541220437379,
  16017788962180639487,
  6788412530732955327,
  9931735548736984115,
  10713513136557947774,
  13218472177889126630,
  6940224330592034598,
  12935804194767658390,
  14957390282302859797,
  15100024538401641276,
  8716157838002662273,
  2175941179744148324,
  2052008306389891286,
  7661319741640265497,
  14261286197536621318,
  814578614513732319,
  15850300882704957684,
  1647363742843247756,
  4874694135786189703,
  18415378437533867051,
  7060909991351193738,
  9416177803660851075,
  2810477393490474588,
  8528305451004154525,
  4728075480027299315,
  2892406378391002235,
  11593604698623586256,
  10173918837970234803,
  8734465869503030892,
  12149067451880108335,
  12502658202531762797,
  1185035967248244075,
  7079338147327218105,
  10230792576294220706,
  6004079583597279835,
  15299911636603154199,
  6694602669623645788,
  14953051605303696766,
  5590978665605509113,
  8037214780899990037,
  13447827689634955395,
  6309006974159703681,
  7138089709347390428,
  934563068445058199,
  5628360818936348717,
  18228886010623687134,
  1561427363802900722,
  8975709227324405853,
  9792769887205591449,
  7730134344614584892,
  3388130948264692978,
  4274696893126183848,
  3887340695565254472,
  3127737740870419476,
  911561999669921202,
  14061545789205191042,
  10631498701211596678,
  8387402086276607699,
  8774943858808576042,
  14226292806683011952,
  590598853473037398,
  11717678355504659765,
  18056470504973517379,
  14706921098049513333,
  9278844908603026218,
  2362414878085051,
  10220220332709108978,
  11832862712011320237,
  1650207547338361599,
  3207611655326635760,
  7569366502468087662,
  16250449533446767251,
  17664733607858908343,
  11106969339530679516,
  11771499384589089403,
  6327485509527933577,
  1605609460875361517,
  14734065633492160097,
  5797670578671453790,
  3244057449495010973,
  10934284356176700643,
  11002674551947291673,
  5541742188893683396,
  6776642739446800664,
  3212374412211932223,
  4228581372136576978,
  2006536274306143193,
  15460078486961427100,
  14209384243735278143,
  14211880746637355477,
  7883630936329095186,
  1261171199833460907,
  7942111096863720154,
  4794747648238576106,
  12568114149921076918,
  15125823575440081307,
  6127123859273139919,
  10128987730323598727,
  12883960128023114708,
  13287406429040971618,
  8117803239220158887,
  13178318863775225592,
  957390802195577833,
  32533691105027727,
  14767647076003764103,
  8722194958176660071,
  2547326718241879051,
  1115060609524737805,
  17680847979990569307,
  12387754567352950253,
  17144592665769257565,
  16983135488992109069,
  15172241560033525536,
  14310059275963528475,
  2295664191401517468,
  16200648981518234701,
  15580343485798507522,
  12615374948201574142,
  5228300708452764402,
  2129056057609946772,
  12711685632873461852,
  13285343078440241857,
  3938076239551761186,
  213174248901994355,
  880126593419927956,
  13821073320381884919,
  9586053005598348425,
  10496249174659853523,
  1291224752549146270,
  362752190121938260,
  4845196103130829122,
  590009420594687690,
  13574171529520180687,
  17013805338240011779,
  5833190026409633996,
  12565156454027850056,
  8056283238364102338,
  8113024156215106190,
  16590885892362026882,
  2544176111237001783,
  17945327200558023180,
  10800164092939835708,
  4558986243650774120,
  14595912679137908507,
  10827354938739672566,
  17826651300898038359,
  12010985405407414896,
  16979904138413002921,
  7458360451669867370,
  658471033267719691,
  8111119019005608834,
  2200556864015277039,
  14152880702594050927,
  9642982390029555371,
  18007298063657471566,
  769219192932610995,
  9905814740929991804,
  5277505597637695125,
  8800621456168827211,
  8833082240431408919,
  4980453122992683783,
  887508166189451839,
  2175479633737841242,
  7300932990315329762,
  185821431762905017,
  6304311444628254513,
  173509641528415692,
  4513853606808193218,
  1726901470267078149,
  16803974414966567836,
  7200631652511188046,
  9047435204731115002,
  13257456567229074440,
  1187653983064928392,
  18278244661118513825,
  1706294871806313170,
  10839154339876867778,
  9082521857690372576,
  13214511465305548853,
  15755080511587426598,
  17094102048221113132,
  17633029369664506504,
  9644977324119969793,
  2425531191879595507,
  6010981974525195878,
  10595310488540873894,
  6143650493144415430,
  6412005572378756300,
  1005661224290835841,
  14762096554891174743,
  16347660909286503812,
  6309298211424995127,
  1640181156785129373,
  1913532803880032665,
  8188652705671226050,
  7495782929468086075,
  18265802629133026772,
  6231100429093074965,
  2048474161728226354,
  7807814783725127933,
  17961902617826643492,
  9199841456637272620,
  12416196036141652278,
  6714568455638520246,
  11438675736661435882,
  178181260495584918,
  7491020211154930616,
  12435305524149548491,
  11319566759414932503,
  3765090466226786382,
  16186494324402127688,
  15458444396995440808,
  9438313652769349103,
  4166266968847117862,
  822693485533048618,
  10324479780052009309,
  12833620674138243831,
  6787021952698927595,
  10178828948979324969,
  10154761937304873781,
  5864458295296251320,
  11888010317973469337,
  102633840648787908,
  337448095374682929,
  8008406363754998622,
  14597803596469379004,
  6048868367838222360,
  3204225417562975025,
  14164237329822631543,
  18343316193807756825,
  15127549848700382833,
  1752289516704488749,
  7827434304567274821,
  3752123810166199656,
  1711827790743444890,
  11259724896982610719,
  12895959753293584029,
  9363932262056386567,
  9690937067649787346,
  8753672661340295302,
  12063176612170616684,
  8671216305407136740,
  1883952784549057341,
  16645142798962290445,
  13127588257699494062,
  6191188433483005531,
  2728573222726768819,
  17815937191715502717,
  17463087573300491818,
  10723892669978609096,
  1096890693655228591,
  17325401000718032174,
  7632030026062491364,
  14888960564553776874,
  18290721077814859377,
  13898567754235545732,
  15043027884472756937,
  14166015290132386548,
  8235453215705390124,
  10599991651024525060,
  10471057927353444509,
  5928823707040743041,
  1739758539346939438,
  17969982141035020709,
  9465274155682904905,
  13402976183128754194,
  8424079869695442247,
  17830234189093049456,
  2743670122227905332,
  15817835217986170776,
  3417151554598427126,
  16623843147641461113,
  4922445638949740198,
  3164463399722242809,
  2097120779730605469,
  17612116006905748408,
  8427321510545937408,
  5458534224501569123,
  2407495880718784547,
  505378668383121326,
  4977836221396404618,
  15068873363352981090,
  17317651201871749979,
  1818178562860474661,
  13183772474997749888,
  14563281537954307164,
  454447268536043696,
  4399735415225699145,
  14047594390301845139,
  7197785753063729308,
  17884750701142579592,
  345664469573949074,
  4238775552905062857,
  3957923509380578338,
  8408149564207354584,
  18187997698846209995,
  650954187677990020,
  5669837017656428561,
  3999952401879740536,
  1116756633045335330,
  10252057641727327299,
  18140036961648222128,
  2757382491629774899,
  9003136784011513907,
  14007144905584519873,
  5014034780263926361,
  427520422666293434,
  10760219564692243141,
  8890283124194346955,
  16211594019826199697,
  9112568295767327398,
  14612326261387379307,
  13964321304890713060,
  6765764542618139825,
  9687089036066070251,
  1141768583049861922,
  9801326873031045085,
  2309308456785837374,
  661765877663496552,
  17368308436106842129,
  11138755280663328172,
  4365333639666890707,
  3080397844236319543,
  4014389440656073005,
  18056040060807375371,
  8563841363216471025,
  16377795224767864628,
  4896306957709097756,
  7641543860916369650,
  16842496971496189576,
  16491167445432845869,
  13667709109703413204,
  12600397058507310843,
  598994998062939145,
  7528038378253870872,
  4424869487298903725,
  7492470729334441476,
  13553030922163990561,
  6021254492865451344,
  9752153028281014261,
  8490559310922708814,
  5700906858211167176,
  4729013805208072196,
  4680602712006811117,
  11792535066835856512,
  17580093572786944501,
  17125468573715415298,
  13410242819211438854,
  17756986409249402505,
  12954052945523287415,
  17022564264632992801,
  12559172691388561533,
  16849837451657243693,
  15610480256436242577,
  11758834318518683999,
  3706633378973520715,
  12429298766557990159,
  6127906630490500410,
  13360310704126494396,
  52274859452893018,
  1370551715555592246,
  2290276585717143779,
  3127187235096325348,
  4224232901155823461,
  7877473572180374966,
  5132079098833552127,
  5139545055466624178,
  1790684129507105621,
  14918096902739123346,
  11846164516174761790,
  597500346551702154,
  16797888572355477620,
  1251932122674598396,
  7338486550283889952,
  15675775825696717806,
  12132314385886320422,
  2478366954546227603,
  13311464590952806519,
  439495534411768377,
  18184571342832199778,
  12547615963708089019,
  7669459144099644733,
  1092424027500027571,
  10654655357488001878,
  18442312360475419157,
  5354008549368682579,
  11247422823828028507,
  15699906557800159610,
  10532742183851820037,
  5146455977963369855,
  17747253074932015146,
  4603047103349010634,
  18127445337545179644,
  702773889681257148,
  7896331954515047340,
  15545679696793507969,
  1430829584155860953,
  5979884463561383628,
  10812130429734908143,
  5073670774040332250,
  1477898112318795259,
  14341972779239675098,
  233686178852917139,
  12086684351311268100,
  10599369229178049955,
  6716901910198781273,
  15983913562385594945,
  6651868532481993722,
  2958650368016379430,
  18252566609678861280,
  17031501691987865699,
];
const WHITE_PIECES: [u64; 729] = [
  9763594473951075206,
  8217835342617381835,
  16959611550518695672,
  1581784320138833537,
  2428926992488822760,
  5596603531119227082,
  7042703900651259607,
  2855316940874693767,
  12791010425022585637,
  16327549330074785906,
  166211910377688882,
  8523273024139810683,
  14594410873769237357,
  14456555189529293536,
  10858332091471658036,
  9274308113310762720,
  15839461235004120250,
  7980141681918010719,
  13958558840153687789,
  8355435372235339478,
  4590702970752482475,
  7848610552135497462,
  6768257959924830792,
  11704653362830714324,
  2814122713029000226,
  12136835528321044858,
  14067446695837119916,
  17989416379201762779,
  15663926207336559668,
  16348623116667706774,
  8408355424914047815,
  16309057040819229254,
  6480016619167560720,
  12172567715340326028,
  12156251941117397111,
  12671166414633230703,
  16349129171431660161,
  12715665493057005120,
  920145249291690566,
  10547266839315659233,
  15391213236841152305,
  14316183759306284270,
  4821642559035405459,
  6493387673702170967,
  11295755679141418934,
  12194570192229584252,
  7090877765656528604,
  8326728964602886771,
  16963883439127127393,
  14059489218225323799,
  8192960199656767572,
  9813165614874001395,
  3372671586602577844,
  7088432435348475328,
  14814324874386100371,
  1583190890111157779,
  14943184195201009013,
  10792877015938555045,
  13510439178923395864,
  16962743648122393484,
  16986035611825598013,
  13720299243445970038,
  10684066457881947978,
  1676518906466862186,
  16615734410204652272,
  4974503104017402553,
  11803916808773704678,
  9563783126620014505,
  7567887380719781864,
  2227490437082571954,
  448925075582132538,
  8316688097122938179,
  6501925750075927221,
  11703952124535015486,
  10800478058272518799,
  12204057480812173411,
  13130113419335460799,
  12170377142836795247,
  16201515049197326983,
  17164257694515545024,
  6482519871582679373,
  16176479126245468536,
  16130342578895592937,
  10533098068545200179,
  2538540550653451161,
  8166536874707294890,
  3760313294768728115,
  494277457636713952,
  6208957543071209244,
  17691508479766411630,
  17633893354235405419,
  16707495790657724904,
  5495797145635497082,
  1393397620097716441,
  16068247626182000628,
  1698532884070057756,
  3507334509813896002,
  12159749690855157958,
  5728893935311691302,
  3709869950326878172,
  18158055234748708939,
  9653803991777887599,
  4851330528555530877,
  13813456308452496330,
  16325423074600425018,
  16844463439581300814,
  7570351296705416916,
  14712998434399994305,
  15306840040231144582,
  16999714595273416463,
  16266834234378676081,
  13700026160902754110,
  7072233113051062709,
  13775986564652019650,
  16336000150480124153,
  6090829513783533470,
  7805469673830082008,
  9227349852044363032,
  7710204782114168705,
  17198338086109845889,
  3954079624060787766,
  7956666158464666095,
  15934087731891565473,
  3774462854671824766,
  15917886028168262185,
  12786521678549507863,
  1911595477932049757,
  11663247509574714682,
  7559576112836207352,
  857397051027783483,
  14802375561655268074,
  13926513084642514794,
  17126363777352703424,
  10808857302527317796,
  189900729215522559,
  11468901014522343731,
  8464310676064929782,
  8552755862822999656,
  13704616180087394477,
  1500990219991409869,
  702224566309152653,
  17533314662689571597,
  14288571924389518567,
  5052901093517896715,
  10995608693902446558,
  6147177644827043812,
  15166896610583092831,
  6320328844293799725,
  6037558512233385876,
  13496564222499686596,
  317354784969708093,
  10335777265853320343,
  15255874029297806688,
  7276177898407417119,
  15572292661777169907,
  18412888197234599008,
  13011637571637670884,
  6418449905748783459,
  10223741475483299376,
  16941385309583447954,
  316871526327955687,
  17255357892234502084,
  3381564472489891326,
  15585599774854830186,
  5451066554245112985,
  13692236643914509030,
  7662731670718401976,
  641365744181310774,
  16782200401538460513,
  6503755932273514390,
  7847260598185940053,
  14567579491352885799,
  8253196418341201188,
  9700158054152370319,
  2770737199438804517,
  8125508427797996505,
  6986330908793491813,
  3018195684059217537,
  16277143049988816907,
  3569022711600455259,
  16759220377032355176,
  6492779161328741945,
  11264982069030730433,
  10922023398504995893,
  3753650535974528420,
  1020920767179059845,
  17968912868165636494,
  3610961570506285631,
  3076998192456793222,
  5226243000712733947,
  2031542640263807596,
  414571438236680473,
  16430262999236224397,
  6747642002457809038,
  6994364024828089691,
  6677416665362787642,
  8161929019984525531,
  16875426074553575382,
  398639783369280385,
  16800562770093279755,
  7886615698044122658,
  4414664857139661192,
  13139956180318206563,
  1317683794602529618,
  1804584501647455808,
  2760001444437789575,
  15175476782239348596,
  10531618580564149856,
  2144791734365748570,
  3341812229114025696,
  8455327032237105510,
  17559524330839641468,
  16853415340671535285,
  1018308953198070328,
  4124692831839514589,
  1797320732511356160,
  18050520294979793693,
  7136033991134835133,
  3954748010108682370,
  3262888852529765990,
  8871441581506099046,
  12702121628225781759,
  12256954779026666300,
  6479868420705098543,
  11440629481535566114,
  9919047336052686893,
  18271659947319373060,
  16608802596686391728,
  16373419841038169175,
  8216258075080466536,
  9877518209784690275,
  12903064163739011760,
  8111475438489447170,
  3129730424939128617,
  852575278289453390,
  11554323299735460308,
  9170863962823017313,
  4278542777803614937,
  14070406177700708806,
  16664426893450584608,
  13922686233118202741,
  13700679084694389472,
  10100682161374916237,
  16700169313923556568,
  15862285312137446276,
  11503484044469708236,
  16389382198720480522,
  3536374345578000539,
  2308676744369124324,
  6316828891615104856,
  12807731545890613851,
  2500517488185337132,
  10444970701220047943,
  1661971465962706655,
  14426995143037957118,
  9864994052078667500,
  12243697793627762333,
  11038615870074088257,
  14393262038988579194,
  3738508102009079736,
  6973278915234630054,
  4729176815009295781,
  6902930105382217046,
  14486513233940391182,
  9281991415000639821,
  12718496021007089058,
  7401074938642900915,
  1151665631399124833,
  13055027367960103464,
  11234879656864222627,
  1163547208898476074,
  2528955410471160242,
  10063076443136759868,
  14208263584717075652,
  7645959841544275830,
  13742611035996750504,
  18304242285445928318,
  16505667257761520062,
  7488153753012648600,
  7237965473328528953,
  11624363598764519181,
  6481890038944762230,
  7553796916607555384,
  13855454158310605705,
  13158642061783223454,
  9276635816938664928,
  12239098591575926022,
  11329681422233610658,
  7055176882410054316,
  10514074632813909097,
  13342844216348654347,
  8502108722143273215,
  13216024021996220753,
  13271174191959310311,
  9838051175026092862,
  2640201528129004603,
  7260310751060409739,
  9423360096078675896,
  7646654407842222227,
  11919995236611922489,
  17657444039348264925,
  3583058083758895308,
  17164608531147940081,
  17879272634614005338,
  76819599564519084,
  17479988543728038315,
  12944777669830070610,
  10974782069953028251,
  6456490385661478292,
  9818988908732922428,
  17506832190421349263,
  4637222183281420022,
  14067900145626347942,
  16885891260271607401,
  10462681707193278161,
  18395100822251937604,
  9464138848329666789,
  18182197723408452075,
  2881155996753509477,
  5767054449593351675,
  14972847733488687948,
  7114690715915885825,
  7575749531366431609,
  8629129035225723007,
  8420398007824033984,
  14804377171620899349,
  16502757131483903802,
  3679770581811270596,
  14659136957006434151,
  13826967750362749133,
  11089471485742299650,
  15237506672542338404,
  385997222555895547,
  16306965721256394404,
  3154214764776667144,
  16638263800553467668,
  6758523833316344699,
  9800896545391820003,
  9395106208871540010,
  5289588880964347379,
  7491433256230137855,
  15664813949433903247,
  1211703950233727563,
  7176196200398572586,
  1092235229668465574,
  8100973844056358807,
  15876474028911785189,
  10126008475297121491,
  11916821358548958978,
  2560236218541949305,
  374276504236601097,
  6948087388021160770,
  10239858022961344130,
  4327568765443982251,
  13624736945325435217,
  3268742748566234201,
  11436529380193065358,
  9407325764056173543,
  11825909740136868247,
  12289142598428908233,
  4395211109536479148,
  11507824079425614123,
  8007243280632738471,
  2331140525490184200,
  12484291236849322047,
  17076406617588530942,
  14521241474871445666,
  1354654486126783770,
  13335504993679971106,
  14910972121956106344,
  10547158805704229457,
  2496935611869682367,
  6140002092945209023,
  14588902456235190750,
  11011481507092530440,
  16607589926348276911,
  13655884628670070238,
  13999014583679737628,
  10433351997190442843,
  11406652225963563739,
  13135499237574086748,
  6225087026512076749,
  5323597022990579844,
  5590890473476547867,
  8044443596137550108,
  9412829617154920070,
  2313225373802825908,
  15210746873985607254,
  9287610252617406747,
  3454855694973308563,
  13280727098199984984,
  12002701626083636406,
  14878011538559819480,
  9383339392887527218,
  14031633183478656863,
  12363731601554291158,
  205105485762974670,
  3183112663430510070,
  13478384493614627580,
  16653338477584923656,
  14272797038930513556,
  1148919313921605519,
  7031419477105355904,
  8883754341596890838,
  14693039181569969120,
  8233737607428007141,
  11540447486221409903,
  3187447886866718357,
  18372664142839036480,
  12739388287586848002,
  2928789391174059158,
  4913954647530448107,
  14153988255874564345,
  5427113567466397313,
  6491215444605464674,
  9107748439951532340,
  12261880227455203891,
  1990364107682378885,
  4356263692125030626,
  3908847626761531527,
  2507931673700443070,
  15217705665438745130,
  3764054903563024550,
  882391286975703034,
  4120188300003389727,
  12619109272723941828,
  6201260168143029028,
  14040773532790060741,
  6985835333751724547,
  4367909214755527705,
  16955265497087514971,
  15884578591569856538,
  4709408238676483827,
  13242642568882522125,
  13128557797952280420,
  17111873287919714737,
  18072638468590396714,
  15962425694369657415,
  7021799672891746133,
  7153897512406137306,
  5847639186814823896,
  10625488995434749868,
  6638335723616298401,
  15818533644245713508,
  1869317867847648130,
  15742005676538159693,
  5071716404945699451,
  6771712212170817794,
  957239493798592024,
  8201321957509830799,
  15150567302216574292,
  9813424959102764087,
  5414952235230382152,
  4853447567371150787,
  16183601875466651289,
  518367966104280098,
  13239900305258417223,
  8187750393469896196,
  11551685996122158053,
  5011370982210931431,
  11821823576686931382,
  17865085221650803389,
  14871780562009727936,
  14727034607484138714,
  3712119371189325879,
  16846200340547356863,
  16669502970907925102,
  6311264518054931624,
  334064554734063932,
  4372235332316437288,
  1721655688946584130,
  4521409209357634505,
  6846519078272594165,
  12002613202860456121,
  3614501872637787999,
  10030690437643280946,
  16461410891178377033,
  8433478465152825698,
  645644302185689184,
  14079873620995564847,
  2831090797495947593,
  10471011725081540649,
  16315667688943494079,
  11281286706634555862,
  5982456188359196316,
  10316837402396943085,
  10508571635469023979,
  11512506760625791440,
  15081746611783036602,
  18213573625873100162,
  17832571997616138792,
  11733689732085120282,
  14758002540023231994,
  12003070927880495067,
  5631544852642903649,
  5374990187712174943,
  4948956458310295644,
  17281700442630825124,
  6221500929074035632,
  11395846771639344960,
  12633579217242371551,
  12083654187978055286,
  1868627054569235746,
  6118832432837001067,
  14143812813907675928,
  8800027370530055630,
  17041378926383776782,
  9966126129719350341,
  2086814012566987466,
  3273133317173256100,
  18297100922241850852,
  14217422657608875496,
  5761547702106405994,
  14542673053139758435,
  7138210805193180305,
  5858612383875054731,
  2052760757379949817,
  13363766993443819841,
  18014012143035212941,
  266366583990789371,
  2930956152338889029,
  8682484211957858425,
  1594544607729783995,
  11954842620706003132,
  4935291708697034708,
  6783467258794294376,
  17438194753018607837,
  7406695341836710010,
  4366948567331328502,
  15785939301018088587,
  16784726867320931477,
  15225646104369971543,
  14404460007601544305,
  2517231392334124707,
  7877364210052838110,
  2580358815936905592,
  10282306052801302096,
  8485508465547825453,
  16316953778130017717,
  16590152780329334841,
  14336069093923760017,
  4288565767097808861,
  921001740341799472,
  11482873329920295854,
  16836011665477352459,
  8594038218635784119,
  10392015164188412582,
  2147259618784667583,
  13366711043752436525,
  12147378516354378163,
  3147703324104037529,
  7113478620331474692,
  5266476675603000316,
  10561269225805337520,
  531102063864881965,
  15929649426327392266,
  5011716119949681631,
  14073667958130489660,
  5643244879472117586,
  7013490601859278100,
  16856098226627236928,
  13152223560615178588,
  12544293741238966866,
  7250882134967256382,
  15458003952792757389,
  4767775171814059541,
  6414510827796762546,
  2303405105486198933,
  17968485282053863324,
  1959917331194483447,
  6106021990960646743,
  1468195126075215030,
  16136819587415926236,
  2967129166199988039,
  8518224124775245596,
  7733849891167725683,
  11780953353238076960,
  2866437007175466500,
  11304078215506564260,
  5502873672472327754,
  2844878241103582073,
  11263610332491073584,
  10268824431871963280,
  10831994899059110623,
  2606036666710590111,
  5123065529496681949,
  6809053315125037647,
  5662383268278647273,
  1698819348777647194,
  11312778002120588504,
  6598746771043678177,
  12928306567675619304,
  3636441059760968056,
  4978091198557106354,
  14820737813818567125,
  6788132031578002160,
  14915285784021679095,
  8291103568547483820,
  9751554055225108538,
  16541958636996121150,
  284220153273769402,
  5133643424784500265,
  1011187201076144486,
  363350861328389987,
  5010886285221929953,
  18152017382467550555,
  5771560877321521096,
  8118271205886388159,
  5193802742789409472,
  8513292654915764318,
  6093775368889595937,
  11096299206829582912,
  17893489175003506932,
  17044823716495320005,
  2229885805949664305,
  6105497168332070082,
  16161097387836829285,
  3285549130621516387,
  1576224174592977941,
  5202255706459740729,
  6611473091731505219,
  12254484754372080125,
  3933842339936373563,
  2480504079987511754,
  4945299438518386348,
  8068998314179546414,
  4410567701163504307,
  9826483005127215106,
  13082848817607208497,
  6850205942523947877,
  18184517216533162316,
  14856956723064098207,
  9841900933082388601,
  7066564422281796006,
  12265567802148888999,
  8825121152041449017,
  497316599439393061,
  9124498473596555406,
  8557810348691562886,
  11478448151462640896,
  17530058177856394004,
  14318793522227418256,
  12649715987898003829,
  2195577249262162923,
  15279824751140125778,
  9005485016631892455,
  17635873014962376321,
  6470216107850681264,
  14593316535151679262,
  4535033060261550822,
  12075250533475403864,
  3665987724445595090,
  1646813140994660681,
  11686757427511105538,
  4920200496820632788,
  99664099821072628,
  8468647089204866991,
  5724844658471027817,
  17543702691618865185,
  16351248727582842036,
  8317230105187767150,
  6793567164253478265,
  778645318473097762,
  14536567170166284889,
  10770327804673910912,
  2856316755011501499,
  3599622774963335572,
  18292524837463703790,
  18150475358619751788,
  4025719979629227058,
  8965396840848487024,
  8661028929602707560,
  911245134270399953,
  14110107079847292406,
  15765340763001960593,
  7512172805503965280,
  17539300290661608911,
  9446647065946321758,
  11044400570555714148,
  1555806007470026333,
  11730144648993514626,
  4353200382754779525,
  8678548789682837940,
  10455226038839920540,
  1421499626473655317,
  2871728732315244747,
  3132970134817960589,
  17067085101525477354,
  6129058238717032223,
  9738768707478729338,
  10246533739516566238,
  5716519038593814212,
  9984965731030062741,
  5813934066234536409,
  8234178296014108588,
  15378880108868493133,
  13347712001745802676,
  65443761215734723,
  15012452749017139081,
  7083672194632831678,
  16452962240006065032,
  16561588969724659889,
  14004601279269715815,
  16773013364881939072,
  9417696464993392974,
  1348022830215415092,
  5714065135510347547,
  1403820808614169357,
  3446934240366676043,
  6491687932713987859,
  9981037428620665984,
  13969732022562003158,
  5101797008816655997,
  14507060636838366554,
  14169988933263619331,
  8602830216108239380,
  2507243710146241387,
  5853203442368406045,
  16850297883846116870,
  12134669001551802406,
  16289709618925323779,
  7424231418590854971,
  17473053946459715604,
  13373149324780295,
  11387206818428322154,
  14405093360387077043,
  9027445613119253763,
  3873294685584304003,
  4231621866130136045,
];
const BLACK_POCKETS: [u64; 42] = [
  5494826743636036243,
  12307298460783327075,
  4989490240903514362,
  5437815013776672757,
  302520415889059539,
  3769940553270184026,
  7152108805393973523,
  12014301402323974865,
  7131608927163131678,
  5015990211776182332,
  7380215964310178466,
  14784177883117896397,
  9068023848758646462,
  17383283146725936311,
  19352329168778550,
  5826765544126256937,
  5042917733240133924,
  8900876658237164252,
  3473628132680763256,
  18140041215191299512,
  5478628259409570795,
  7149485210206158002,
  7211525708904751687,
  13322007940388045888,
  8245834108753153830,
  6821182397825584506,
  8833132980134173782,
  848591376532106326,
  14575661995720187389,
  4577169000833879913,
  8095987770192102346,
  1538304819945530993,
  9868430152666899662,
  12685897280664098061,
  13059142834857856437,
  10463780705208929893,
  374691896431358514,
  3503060451709835823,
  4893348307729564251,
  3199787368609011245,
  16256366879980681985,
  335398392330589428,
];
const WHITE_POCKETS: [u64; 42] = [
  10946906138191551463,
  12905740351020654267,
  8147158298737281254,
  7027212210483390964,
  2439588867097455773,
  8159900355888773983,
  14554029627802622555,
  17964868226335238715,
  6145261144175338875,
  153036076983695413,
  12585624472855912239,
  15653692108805735814,
  9619791817360342240,
  925712092450699781,
  13539891216501756204,
  2814722913378299532,
  5448293356726095282,
  862807637369992615,
  13675605724178613180,
  5730615338678479860,
  6135770986143890424,
  9110910956570160076,
  745299985605367783,
  8089332684126481556,
  5648593022456824749,
  7449979595048123860,
  5236812968765385433,
  12696548086867594580,
  15992554049833287227,
  15379204416030259396,
  8187658813431909095,
  18404785419108622313,
  11153929848452657873,
  5622102206644181348,
  2396093256207311513,
  10902992921201378172,
  18421624502436803558,
  4914853571115396242,
  1136296780264186821,
  1167201032534073405,
  16159241118024765466,
  3474458001231781766,
];

pub fn get_piece_hash(piece: i8, cell: usize) -> u64 {
  assert_ne!(piece, piece::NONE);
  let q = if piece > 0 {
    &BLACK_PIECES
  } else {
    &WHITE_PIECES
  };
  let piece = piece.abs();
  if piece >= piece::PROMOTED {
    q[cell] ^ q[81 * (piece - piece::PROMOTED) as usize + cell]
  } else {
    q[81 * piece as usize + cell]
  }
}

fn get_pocket_hash(p: &[u64], abs_piece: i8, c: u8) -> u64 {
  assert!(abs_piece > 0);
  assert!(c > 0);
  if abs_piece == piece::PAWN {
    p[23 + (c as usize)]
  } else {
    p[4 * (abs_piece - 2) as usize + (c as usize) - 1]
  }
}

pub fn get_black_pocket_hash(abs_piece: i8, c: u8) -> u64 {
  get_pocket_hash(&BLACK_POCKETS, abs_piece, c)
}

pub fn get_cumulative_black_pocket_hash(abs_piece: i8, c: u8) -> u64 {
  (1..=c).fold(0, |acc, i| {
    acc ^ get_pocket_hash(&BLACK_POCKETS, abs_piece, i)
  })
}

pub fn get_white_pocket_hash(abs_piece: i8, c: u8) -> u64 {
  get_pocket_hash(&WHITE_POCKETS, abs_piece, c)
}

pub fn get_cumulative_white_pocket_hash(abs_piece: i8, c: u8) -> u64 {
  (1..=c).fold(0, |acc, i| {
    acc ^ get_pocket_hash(&WHITE_POCKETS, abs_piece, i)
  })
}

pub fn compute_black_pockets_hash(black_pockets: &[u8]) -> u64 {
  black_pockets
    .iter()
    .enumerate()
    .skip(1)
    .filter(|&(_, &c)| c > 0)
    .fold(0, |acc, (p, &c)| {
      acc ^ get_cumulative_black_pocket_hash(p as i8, c)
    })
}

pub fn compute_white_pockets_hash(white_pockets: &[u8]) -> u64 {
  white_pockets
    .iter()
    .enumerate()
    .skip(1)
    .filter(|&(_, &c)| c > 0)
    .fold(0, |acc, (p, &c)| {
      acc ^ get_cumulative_white_pocket_hash(p as i8, c)
    })
}
